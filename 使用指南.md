# PCAP生成工具 - 使用指南

## 🚀 快速开始

### 1. 环境准备
确保您的系统已安装Python 3.7或更高版本：
```bash
python --version
```

### 2. 安装依赖
在项目目录下运行：
```bash
pip install scapy
```
或者：
```bash
pip install -r requirements.txt
```

### 3. 验证安装
运行快速测试：
```bash
python quick_test.py
```

### 4. 启动程序
```bash
python main.py
```
或者双击 `run.bat` 文件

## 📋 界面使用说明

### 以太网配置
- **源MAC地址**: 发送方MAC地址，格式如 `00:11:22:33:44:55`
- **目标MAC地址**: 接收方MAC地址，支持冒号或短横线分隔

### IP层配置
- **IP版本**: 选择IPv4或IPv6
- **源IP地址**: 发送方IP地址
- **目标IP地址**: 接收方IP地址
- **IPv4参数**: TTL（生存时间）、TOS（服务类型）
- **IPv6参数**: Hop Limit（跳数限制）、Traffic Class（流量类别）

### 传输层配置
- **协议**: 选择TCP或UDP
- **源端口**: 发送方端口（1-65535）
- **目标端口**: 接收方端口（1-65535）
- **数据大小**: TCP数据字节数（会自动分片）

## 🔧 操作步骤

1. **配置网络参数**
   - 填写所有必要的网络配置
   - 程序会自动验证输入格式

2. **生成数据包**
   - 点击"生成数据包"按钮
   - 等待状态栏显示生成结果

3. **保存PCAP文件**
   - 点击"保存PCAP文件"按钮
   - 选择保存位置和文件名

## 📝 配置示例

### TCP连接示例
```
源MAC: 00:11:22:33:44:55
目标MAC: AA:BB:CC:DD:EE:FF
IP版本: IPv4
源IP: 192.168.1.100
目标IP: 192.168.1.200
TTL: 64
TOS: 0
协议: TCP
源端口: 12345
目标端口: 80
数据大小: 2920
```
这将生成：
- SYN包（连接请求）
- SYN-ACK包（连接响应）
- ACK包（连接确认）
- 2个数据包（每个1460字节）
- 对应的ACK响应包

### UDP包示例
```
源MAC: 00:11:22:33:44:55
目标MAC: AA:BB:CC:DD:EE:FF
IP版本: IPv6
源IP: 2001:db8::1
目标IP: 2001:db8::2
协议: UDP
源端口: 53
目标端口: 53
数据大小: 512
```

## 🛠️ 故障排除

### 常见问题

**Q: 提示"No module named 'scapy'"**
A: 运行 `pip install scapy` 安装scapy库

**Q: MAC地址格式错误**
A: 使用格式 `XX:XX:XX:XX:XX:XX` 或 `XX-XX-XX-XX-XX-XX`

**Q: IP地址无效**
A: 检查IPv4格式（如192.168.1.1）或IPv6格式（如2001:db8::1）

**Q: 端口号无效**
A: 端口范围必须在1-65535之间

**Q: 生成的PCAP文件无法打开**
A: 确保文件完整保存，可用Wireshark等工具验证

### 环境问题

**如果遇到conda环境问题：**
1. 打开命令提示符（不是PowerShell）
2. 直接运行：`python main.py`
3. 或者使用提供的 `run.bat` 文件

**如果Python版本过低：**
- Windows 7最高支持Python 3.8
- 建议使用Python 3.7或3.8

## 📦 打包部署

### 创建独立exe文件
```bash
python build.py
```
或运行：
```bash
build.bat
```

生成的exe文件位于 `dist/PcapGenerator.exe`，可在任何Windows 7+系统上运行。

## 🔍 验证输出

生成的PCAP文件可以用以下工具打开：
- **Wireshark**: 图形化网络分析工具
- **tcpdump**: 命令行抓包工具
- **tshark**: Wireshark命令行版本

### Wireshark验证步骤
1. 打开Wireshark
2. File → Open → 选择生成的.pcap文件
3. 查看数据包列表和详细信息
4. 验证MAC地址、IP地址、端口等信息

## 📞 技术支持

如果遇到问题：
1. 首先运行 `python quick_test.py` 检查环境
2. 检查Python版本是否为3.7+
3. 确认scapy库已正确安装
4. 查看错误信息并对照故障排除部分

## 🎯 使用场景

- **网络测试**: 生成特定的网络流量进行测试
- **协议分析**: 创建标准的网络包用于分析
- **教学演示**: 展示网络协议的工作原理
- **安全测试**: 生成测试数据包进行安全验证

工具已完全满足Windows 7兼容性要求，提供完整的图形界面和网络包生成功能！
